var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,i=function(n){var o=t.createEvent("MouseEvents");o.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(o)},a=e.webkitRequestFileSystem,c=e.requestFileSystem||a||e.mozRequestFileSystem,s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f=0,l=function(t){var o=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?o():setTimeout(o,10)},d=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){s(e)}}},u=function(t,s){var u,v,h,m=this,p=t.type,x=!1,w=function(){d(m,"writestart progress write writeend".split(" "))},y=function(){if(!x&&u||(u=n().createObjectURL(t)),v)v.location.href=u;else{void 0==e.open(u,"_blank")&&"undefined"!=typeof safari&&(e.location.href=u)}m.readyState=m.DONE,w(),l(u)},b=function(e){return function(){if(m.readyState!==m.DONE)return e.apply(this,arguments)}},E={create:!0,exclusive:!1};return m.readyState=m.INIT,s||(s="download"),r?(u=n().createObjectURL(t),o.href=u,o.download=s,i(o),m.readyState=m.DONE,w(),void l(u)):(e.chrome&&p&&"application/octet-stream"!==p&&(h=t.slice||t.webkitSlice,t=h.call(t,0,t.size,"application/octet-stream"),x=!0),a&&"download"!==s&&(s+=".download"),("application/octet-stream"===p||a)&&(v=e),c?(f+=t.size,void c(e.TEMPORARY,f,b(function(e){e.root.getDirectory("saved",E,b(function(e){var n=function(){e.getFile(s,E,b(function(e){e.createWriter(b(function(n){n.onwriteend=function(t){v.location.href=e.toURL(),m.readyState=m.DONE,d(m,"writeend",t),l(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=m["on"+e]}),n.write(t),m.abort=function(){n.abort(),m.readyState=m.DONE},m.readyState=m.WRITING}),y)}),y)};e.getFile(s,{create:!1},b(function(e){e.remove(),n()}),b(function(e){e.code===e.NOT_FOUND_ERR?n():y()}))}),y)}),y)):void y())},v=u.prototype,h=function(e,t){return new u(e,t)};return v.abort=function(){var e=this;e.readyState=e.DONE,d(e,"abort")},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,h}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return saveAs}),function(e){"use strict";var t=(String.fromCharCode,function(){try{document.createElement("$")}catch(e){return e}}(),function(e){var t=e.textContent||e.innerText;return null==t?"":t.replace(/^\s*(.*?)\s+$/,"$1")});e.tableExport=function(n,o,r){var i=e.document,a=i.getElementById(n),c=i.characterSet,s={json:"application/json;charset="+c,txt:"csv/txt;charset="+c,csv:"csv/txt;charset="+c,doc:"application/vnd.ms-doc",excel:"application/vnd.ms-excel"},f=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})},l=function(){return e.Blob},d=function(e){var t=e,n=-1!==e.indexOf(",")||-1!==e.indexOf("\r")||-1!==e.indexOf("\n"),o=-1!==e.indexOf('"');return o&&(t=t.replace(/"/g,'""')),(n||o)&&(t='"'+t+'"'),t},u=function(e){var t=l();saveAs(new t([e],{type:s[r]}),o+"."+r)},v=function(){for(var e,n="\ufeff",o=0;e=a.rows[o];o++){for(var r,i=0;r=e.cells[i];i++)n=n+(i?",":"")+d(t(r));n+="\r\n"}u(n)},h=function(){var e=[];if(a.tHead)for(var n,o=0;n=a.tHead.rows[0].cells[o];o++)e.push(t(n));var r=[];if(a.tBodies)for(var i,c=0;i=a.tBodies[c];c++)for(var s,f=0;s=i.rows[f];f++){var l=r.length;r[l]=[];for(var d,v=0;d=s.cells[v];v++)r[l].push(t(d))}var h={header:e,data:r};u(JSON.stringify(h))},m=function(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:'+r+'" xmlns="http://www.w3.org/TR/REC-html40">';e+='<head><meta charset="'+c+'" />\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>',e+="{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e",e+="</head><body><table>{table}</table></body></html>";for(var n,o="",i=[["<thead><tr>","</tr></thead>"],["<tbody><tr>","</tr></tbody>"],["<tr>","</tr>"]],s=[["<th>","</th>"],["<td>","</td>"]],l=+!a.tHead,d=1-l,v=0;n=a.rows[v];v++){l=v>d?2:l,o+=i[l][0];for(var h,m=0;h=n.cells[m];m++)o+=s[+!!l][0]+t(h)+s[+!!l][1];o+=i[l][1],l++}u(f(e,{worksheet:"Worksheet",table:o}))};({json:h,txt:v,csv:v,doc:m,docx:m,xls:m,xlsx:m})[r]()}}(window);