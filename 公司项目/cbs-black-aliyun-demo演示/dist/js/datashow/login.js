$(function(){$login.username.val(""),$login.password.val(""),loginFun.init()}),window.$login={username:$("#username"),password:$("#password"),username_input:$(".username-nofocus"),pasword_input:$(".userpas-nofocus"),loading:$(".loading")};var loginFun={init:function(){$login.username.bind("keypress",function(e){"13"==e.keyCode&&$login.password.focus()}),$login.password.bind("keypress",function(e){"13"==e.keyCode&&(""==$login.username.val()?$login.username.focus():loginFun.logIn())})},namefocus:function(){$login.username_input.addClass("username-onfocus")},nameblue:function(){$login.username_input.removeClass("username-onfocus")},pasfocus:function(){$login.pasword_input.addClass("userpas-onfocus")},pasblue:function(){$login.pasword_input.removeClass("userpas-onfocus")},logIn:function(){if(""===$login.username.val())layer.msg("用户名不能为空");else if(""===$login.password.val())layer.msg("密码不能为空");else{$login.loading.show();var e={username:$login.username.val(),password:$login.password.val()};$.ajax({url:apiurl+"login",type:"put",dataType:"json",data:e,success:function(e){if($login.loading.hide(),e.success){switch(Number(e.data.system_role_id)){case 1:sessionStorage.setItem("isadmin","1");break;case 2:sessionStorage.setItem("isadmin","2");break;default:sessionStorage.setItem("isadmin","1")}location.href="deviceControlCanvas.html"}else layer.msg(e.error_message)},error:function(e){$login.loading.hide(),layer.msg(e.error_message)}})}},forgetpas:function(){layer.open({title:["提示","font-size:18px;color:#fff;background:#3E4687;height:50px;font-weight:bold;line-height:50px;padding-left:30px;border:none;"],type:1,skin:"layui-primary",area:["540px","225px"],content:$("#forget-pas"),shift:2,move:!1})}};