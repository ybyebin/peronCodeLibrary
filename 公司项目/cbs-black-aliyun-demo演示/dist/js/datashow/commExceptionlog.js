function commExcLoadData(t){var e=["start_time="+$("#startTime").val(),"end_time="+$("#endTime").val()+" 23:59:59","page="+t,"page_item_count=13"];$.ajax({url:apiurl+"NodeLog/1?"+e.join("&"),type:"GET",beforeSend:function(){$(".loading").show()},complete:function(){$(".loading").hide()},success:function(e){if($(".loading").hide(),e.success){var a=e.data.items;null==a&&(a=[]);for(var i in a)switch(a[i].status){case 1:a[i].status="正常";break;case 2:a[i].status="异常"}$("#commExclog-tbody tr td").html(""),$("#commExclog-tbody tr").each(function(t,e){if(t<a.length){var i="<td>"+a[t].name+"</td><td>"+a[t].ip+"</td><td >"+a[t].status+"</td><td >"+a[t].create_time+"</td>";$(e).html(i)}}),0===e.data.pageCount?(layer.msg("无数据"),$(".tcdPageCode").html("")):$(".tcdPageCode").createPage({pageCount:e.data.pageCount,current:t,backFn:function(t){commExcLoadData(t)}})}else layer.msg(e.error_message)},error:function(t){$(".loading").hide(),layer.msg(t.error_message),returnLogIn(t)}})}function exportUserOperationLog(){var t=$("#startTime").val(),e=$("#endTime").val()+" 23:59:59";""!==t&&""!==e?t>e?layer.msg("开始时间大于结束时间"):compareYear(new Date(t),10)<=e?layer.msg("超过统计时间限制"):$.ajax({url:apiurl+"nodeLog?start_time="+t+"&end_time="+e+"&name=通信异常日志",type:"PUT",dataType:"json",success:function(t){t.success?window.location.href="../"+t.data:layer.msg(t.error_message)},error:function(t){layer.msg(t.error_message),returnLogIn(t)}}):layer.msg("时间区间不能为空")}$("#foot").load("public.html"),$(function(){publicHeadfun(),days(),$("#slectFen ul li a").click(function(){var t=!0;$("span.txt").text($(this).text());var e=$(this).attr("rel");1==e||2==e?($("#startTime").val($(this).attr("value")),$("#endTime").val($(this).attr("value"))):3==e||4==e||5==e?($("#startTime").val($(this).attr("value")),$("#endTime").val(compareDate(1,0))):6==e||7==e||8==e?($("#startTime").val($(this).attr("value")),6==e?counts=1:7==e?counts=2:8==e&&(counts=3),$("#endTime").val(getCurrentMonthLastForSelect($(this).attr("value")))):9==e&&(t=!1,$("#startTime").val(""),$("#endTime").val("")),t&&commExcLoadData(1)}),$("#slectFen ul li:nth-child(4) a").click()}),$("#startTime").datepicker({format:"yyyy-mm-dd ",autoclose:!0,todayBtn:!1,pickerPosition:"bottom-right",minView:2}).on("changeDate",function(t){$("#slectFen button .txt").html("自定义").attr("rel",9),$("#endTime")[0].focus()}),$("#endTime").datepicker({format:"yyyy-mm-dd ",autoclose:!0,todayBtn:!1,pickerPosition:"bottom-right",minView:2}).on("changeDate",function(t){$("#slectFen button .txt").html("自定义").attr("rel",9),timebeginisTrue=!0,checkEndTime("startTime","endTime",1)||($("#endTime").val(""),layer.msg("结束时间需晚于开始时间"),timebeginisTrue=!1),compareYear(new Date($("#startTime").val()),10)<=t.date.toLocaleDateString()&&(layer.msg("超过统计时间限制"),$("#endTime").val(""),timebeginisTrue=!1),timebeginisTrue&&commExcLoadData(1)});