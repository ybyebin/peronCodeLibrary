function displayJSON(e){(new draw2d.io.json.Writer).marshal(e,function(e){})}function getGroupNameAndViewName(e){var n=$(".loading");$.ajax({url:"/api/view/"+e,type:"GET",beforeSend:function(){n.show()},complete:function(){n.hide()},success:function(e){n.hide(),e.success?($(".go-subsys span").text(sessionStorage.getItem("viewGroupeName")),null!==e.data&&$(".group-name").text(e.data.name)):layer.msg("获取画面数据失败:"+e.error_message)},error:function(e){publicAjaxError(e)}})}var pageOne="页面1",imageCanvas;$(window).load(function(){draw2d.Configuration.factory.createConnection=function(e,n,o,t){return new HoverConnection(e,n)},draw2d.Configuration.factory.createResizeHandle=function(e,n){var o=new draw2d.ResizeHandle(e,n);return o.attr({width:10,height:10,radius:0,color:"#35C99D",stroke:1,bgColor:"#35C99D"}),o};var e=new example.Application,n=e.view,o=n.paper.createFilter();o.createShadow(0,0,3,.3,"#000000"),o.element.setAttribute("x","-35%"),o.element.setAttribute("y","-35%"),n.on("figure:add",function(e,n){n.figure instanceof draw2d.Connection||n.figure.shape.filter(o)}),n.installEditPolicy(new draw2d.policy.canvas.SnapToGeometryEditPolicy({lineColor:"#35c99d"})),n.installEditPolicy(new draw2d.policy.canvas.SnapToInBetweenEditPolicy({lineColor:"#35c99d"})),n.installEditPolicy(new draw2d.policy.canvas.SnapToCenterEditPolicy({lineColor:"#35c99d"})),n.installEditPolicy(new draw2d.policy.canvas.CoronaDecorationPolicy),n.installEditPolicy(new draw2d.policy.canvas.BoundingboxSelectionPolicy),imageCanvas=n,n.getCommandStack().addEventListener(function(e){e.isPostChangeEvent()&&displayJSON(n)}),getGroupNameAndViewName(sessionStorage.getItem("view_id"),n)});var HoverConnection=draw2d.Connection.extend({init:function(e,n){var o=this;this._super({router:new draw2d.layout.connection.InteractiveManhattanConnectionRouter,radius:5,stroke:1.35,color:"#68C9FF"}),this.on("dragEnter",function(e,n){o.attr({outlineColor:"#68C9FF",outlineStroke:2,color:"#68C9FF"})}),this.on("dragLeave",function(e,n){o.attr({outlineColor:"#68C9FF",outlineStroke:0,color:"#68C9FF"})})},onDragEnter:function(e){return this}});